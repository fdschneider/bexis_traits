---
title: "Ecological Traitdata Standard"
author: "Florian D. Schneider, Nadja Simons, Caterina Penone, Andreas Ostrowski"
date: "12 Mai 2017"
output: 
  html_document: 
    keep_md: yes
    toc: yes
---


**This is the documentation of the Ecological Traitdata Standard (ETS), version 0.3** 

This defined vocabulary aims at providing all essential columns for raw data of functional trait measurements for ecological research. 

Most terms relate to terms from the Darwin Core Standard and Extensions (Names compliant with DWC are referenced thus in field 'Refines'; the full Darwin Core can be found here: http://rs.tdwg.org/dwc/terms/index.htm)

The data standard is ordered into a **core section** with essential columns for trait data, extensions which are allowing to provide additional layers of information, as well as a vocabulary for metadata information of particular importance for trait data. A final section provides defined terms for lists of trait definitions, also termed a Trait Thesaurus. 

Extensions:

- the `Occurence` extension contains information on the level of individual specimens, such as date and location and method of sampling and preservation, or physiological specifications of the phenotype, such as sex, life stage or age. 
- the `MeasurementOrFact` extension takes information at the level of single measurements or reported values, such as the original literature from where the value is cited, the method of measurement or statistical method of aggregation. 
- The extension `BiodiversityExploratories` provides columns for localisation for trait data from the Biodiversity Exploratories sites (ww.biodiversity-exploratories.de). 


This list will also be available as 

- a csv/txt/xlsx table file which will be provided for download on BExIS including full documentation in the metadata (for manual use, this may be uploaded to BExIs as soon it's ready), and
- a machine readable template glossary (xml file or csv with additional flags and markers) which serves as input reference for software tools. (can we provide a simple API?) 

```{r, results = 'asis', echo = FALSE}
library(data.table)
library(knitr)
glossary <- read.csv("../template_glossary.csv")

columnNames <- glossary$columnName
sections <- glossary$Namespace
sectionNames <- levels(glossary$Namespace)

glossary <- as.data.table(glossary)
glossary <- setNames(split(glossary[,-c(1), with = FALSE], f = as.integer(glossary$Namespace)), sectionNames)

glossary <- lapply(glossary, function(x) setNames(split(x, f = seq_along(x$columnName)), x$columnName))

```

# Core traitdata columns

Generally, for the essential primary data (taxon assignment, trait name, trait value), the trait data standard recommends to keep the original naming and value of the data provider to ensure compatibility on the provider's side and to check for inconsistencies and misspellings. To ensure compatibility with other datasets, the original data provider's information should be transferred into a standardized columns indexed by appending `Std` to the column name. 
The R package 'traitdataform' helps in transferring those entries into the accepted taxon names and trait definitions provided by public ontologies. 

```{r, results = 'asis', echo = FALSE}

j <- "Traitdata"

 for(i in columnNames[sections == j]) {
     dd <- as.data.frame(t(glossary[[j]][[as.character(i)]][,-1, with=FALSE]))
     colnames(dd) <- i
     cat("## `", i, "`  ", sep = "")
     print(kable(dd, format = "markdown"))
 }

```


# Extension: Measurement or Fact 

This section provides additional information about the specimen, which are not captured by the taxon information above.  


```{r, results = 'asis', echo = FALSE}

j <- "MeasurementOrFact"

 for(i in columnNames[sections == j]) {
   dd <- as.data.frame(t(glossary[[j]][[as.character(i)]][,-1, with=FALSE]))
     colnames(dd) <- i
     cat("## `", i, "`  ", sep = "")
   print(kable(dd, format = "markdown"))
 }

```


# Columns referring to occurence 

this section of columns aims for identifying the methodology and primary source of the data and keep the reference to the actual specimen (e.g. for museum collections or related data analysis). 

```{r, results = 'asis', echo = FALSE}

j <- "Occurence"

 for(i in columnNames[sections == j]) {
    dd <- as.data.frame(t(glossary[[j]][[as.character(i)]][,-1, with=FALSE]))
     colnames(dd) <- i
     cat("## `", i, "`  ", sep = "")
 print(kable(dd, format = "markdown"))
 }

```

# Additional columns for use in Biodiversity Exploratories

This section records location in the context of the exploratories. From `ExploratotriesPlotID` a detailled georeference can be inferred. Additional spatial resolution, e.g. on subplots, may be provided in `locationID` of section sampling event. 

```{r, results = 'asis', echo = FALSE}

j <- "BiodiversityExploratories"

 for(i in columnNames[sections == j]) {
      dd <- as.data.frame(t(glossary[[j]][[as.character(i)]][,-1, with=FALSE]))
     colnames(dd) <- i
     cat("## `", i, "`  ", sep = "")
     print(kable(dd, format = "markdown"))
 }

``` 

# Metadata vocabulary

```{r, results = 'asis', echo = FALSE}

j <- "Metadata"

 for(i in columnNames[sections == j]) {
      dd <- as.data.frame(t(glossary[[j]][[as.character(i)]][,-1, with=FALSE]))
     colnames(dd) <- i
     cat("## `", i, "`  ", sep = "")
     print(kable(dd, format = "markdown"))
 }

```

# Terms for Traitlists / Trait Thesaurus

```{r, results = 'asis', echo = FALSE}

j <- "Traitlist"

 for(i in columnNames[sections == j]) {
      dd <- as.data.frame(t(glossary[[j]][[as.character(i)]][,-1, with=FALSE]))
     colnames(dd) <- i
     cat("## `", i, "`  ", sep = "")
     print(kable(dd, format = "markdown"))
 }

```

----

<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Ecological Traitdata Standard </span> by <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Florian D. Schneider, Nadja Simons, Caterina Penone, Andreas Ostrowski</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
